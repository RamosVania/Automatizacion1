<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chatbot AI - &lt;script&gt;alert('HACKED')&lt;/script&gt; Corp</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  <header class="bg-indigo-700 text-white p-6 shadow-md flex items-center justify-between">
    <h1 class="text-xl font-bold">Chatbot AI</h1>
    <button onclick="location.href='../../index.html'" class="bg-indigo-600 hover:bg-indigo-800 transition rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-300">Volver</button>
  </header>
  <main class="flex-grow p-6 max-w-4xl mx-auto">
    <section class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-lg font-semibold mb-4">Interactúa con nuestro asistente inteligente</h2>
      <p class="text-gray-700 mb-6">Este módulo te permite conversar con un chatbot basado en inteligencia artificial para ayudarte con tus consultas.</p>
      <div id="chatContainer" class="border border-gray-300 rounded-md p-4 h-96 overflow-y-auto bg-gray-100 mb-4"></div>
      <form id="chatForm" class="flex gap-2">
        <input type="text" id="userInput" placeholder="Escribe tu mensaje..." aria-label="Escribe tu mensaje" required class="flex-grow px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" autocomplete="off" />
        <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition">Enviar</button>
      </form>
    </section>
  </main>
  <script>
    const chatContainer = document.getElementById('chatContainer');
    const chatForm = document.getElementById('chatForm');
    const userInput = document.getElementById('userInput');

    function appendMessage(message, sender) {
      const messageEl = document.createElement('div');
      messageEl.className = sender === 'user' ? 'text-right mb-2' : 'text-left mb-2';
      const bubble = document.createElement('span');
      bubble.className = sender === 'user' ? 'inline-block bg-indigo-600 text-white px-4 py-2 rounded-lg max-w-xs break-words' : 'inline-block bg-gray-300 text-gray-900 px-4 py-2 rounded-lg max-w-xs break-words';
      bubble.textContent = message;
      messageEl.appendChild(bubble);
      chatContainer.appendChild(messageEl);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function generateBotResponse(userMessage) {
      // Respuesta simple simulada
      const responses = [
        '¡Hola! ¿En qué puedo ayudarte hoy?',
        'Estoy aquí para asistirte con cualquier consulta.',
        'Por favor, proporciona más detalles para ayudarte mejor.',
        'Gracias por contactarnos. ¿Quieres saber más sobre nuestros servicios?',
        'Lo siento, no entendí eso. ¿Puedes reformular tu pregunta?'
      ];
      // Elegir respuesta aleatoria
      return responses[Math.floor(Math.random() * responses.length)];
    }

    chatForm.addEventListener('submit', function(event) {
      event.preventDefault();
      const message = userInput.value.trim();
      if (!message) return;

      appendMessage(message, 'user');
      userInput.value = '';

      setTimeout(() => {
        const botResponse = generateBotResponse(message);
        appendMessage(botResponse, 'bot');
      }, 700);
    });
  </script>

<script>
(function(){
  try{
    const s = JSON.parse(localStorage.getItem('mvp_session')||'null');
    if(!s || !s.user){ location.href = './login.html'; }
  }catch(_){ location.href = './login.html'; }
})();
</script>
</body>
</html>